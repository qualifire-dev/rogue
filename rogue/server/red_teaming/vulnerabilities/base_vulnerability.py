"""
Base vulnerability class for red teaming.

Adapted from deepteam/vulnerabilities/base_vulnerability.py for Rogue's architecture.
"""

from abc import ABC
from enum import Enum
from typing import List


class BaseVulnerability(ABC):
    """
    Base class for vulnerability detection.

    Vulnerabilities define what security weaknesses to test for and how to detect them.
    """

    name: str

    def __init__(self, types: List[Enum]):
        """
        Initialize a Vulnerability with a list of specific types.

        Args:
            types: A list of Enum types representing vulnerability subtypes
        """
        self.types = types

    def get_types(self) -> List[Enum]:
        """
        Get the list of Enum types.

        Returns:
            List of Enum types
        """
        return self.types

    def get_values(self) -> List[str]:
        """
        Get the list of string values for the Enum types.

        Returns:
            List of string values from the Enum types
        """
        return [t.value for t in self.types]

    def get_name(self) -> str:
        """Get the name of this vulnerability."""
        return self.name

    def __repr__(self) -> str:
        """String representation of the Vulnerability class."""
        return f"{self.__class__.__name__} (types={self.types})"
